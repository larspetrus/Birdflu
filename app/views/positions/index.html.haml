%h3 Last Layer Positions With Solutions

%h5{style: 'position: absolute; top:0; right:0; '}
  = link_to "H codes", "http://www.ai.univ-paris8.fr/~bh/cube/solutions_tout.html"

=form_tag url_for(controller: "positions", action: "index"), method: 'get', class: "search_form" do
  %div
    =label_tag(:cp, "Swapped corners")
    =select_tag(:cp, options_for_select([["None", "None"], ["Adjacent", "Adjacent"], ["Diagonal", "Diagonal"]], @pcp), include_blank: true)
  %div
    =label_tag(:co, "Oriented corners")
    =select_tag(:co, options_for_select([["0", "0"], ["1", "1"], ["2", "2"], ["4", "4"]], @query['oriented_corners']), include_blank: true)
  %div
    =label_tag(:eo, "Oriented edges")
    =select_tag(:eo, options_for_select([["0", "0"], ["2", "2"], ["4", "4"]], @query['oriented_edges']), include_blank: true)
  %div
    =submit_tag("Reload")


%h5 Showing #{@positions.count} of all #{Position.count} positions. #{ComboAlg.count(:position_id)}  solutions total

%table.index
  %th LL_CODE
  %th Mirror
  %th CP
  %th CO
  %th EO
  %th Wt
  %th Solutions
  %th Best Solution
  %th Moves
  %th Name

  - @positions.each do |pos|
    - best = pos.best_alg || OpenStruct.new
    %tr
      %td= link_to pos.ll_code, "positions/#{pos.ll_code}"
      %td= link_to pos.mirror_ll_code, "positions/#{pos.mirror_ll_code}" if pos.ll_code != pos.mirror_ll_code
      %td= pos.corner_swap_symbol
      %td= pos.oriented_corners
      %td= pos.oriented_edges
      %td= pos.weight > 1 ? "Ã—#{pos.weight}" : ""
      %td.num= pos.alg_count
      %td
        =best.mv_start
        %span.cancel1= best.mv_cancel1
        %span.merged=  best.mv_merged
        %span.cancel2= best.mv_cancel2
        %span.alg2=    best.mv_end
      %td.num= best.length
      %td{:class => best.oneAlg? ? 'one-alg' : ''}= best.name
